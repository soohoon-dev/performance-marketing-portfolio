<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>What Skill Will Make You Valuable? | Career Capital Builder</title>

    <!-- GTM -->
    <script>
      (function(w,d,s,l,i){w[l]=w[l]||[];
        w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
        var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
        j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
        f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-NPRM5NWS');
    </script>

    <!-- Meta Tags for Social Sharing -->
    <meta property="og:title" content="What Skill Will Make You Valuable in 3 Years?" />
    <meta
      property="og:description"
      content="Based on Cal Newport's 'So Good They Can't Ignore You'. Build career capital through rare, valuable skills."
    />
    <meta property="og:type" content="website" />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap");

      :root {
        --primary: #2563eb;
        --primary-dark: #1d4ed8;
        --bg: #f8fafc;
        --text: #0f172a;
        --card: #fff;
        --border: #e2e8f0;
        --success: #10b981;
        --muted: #64748b;
      }

      * { box-sizing: border-box; }
      html { scroll-behavior: smooth; }

      body {
        margin: 0;
        font-family: 'Inter', sans-serif;
        background: var(--bg);
        color: var(--text);
        padding: 0 0 100px;
        line-height: 1.6;
      }

      .container { max-width: 600px; margin: 0 auto; padding: 20px; }

      /* Hero Section */
      header { text-align: center; padding: 48px 20px 32px; }

      .badge {
        display: inline-block;
        background: #eff6ff;
        color: var(--primary);
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        margin-bottom: 16px;
        border: 1px solid #dbeafe;
      }

      h1 {
        font-size: 2rem;
        line-height: 1.2;
        margin: 0 0 16px;
        letter-spacing: -0.5px;
        font-weight: 800;
      }

      .sub {
        color: var(--muted);
        font-size: 1rem;
        margin-bottom: 24px;
        line-height: 1.5;
      }

      /* Social Proof */
      .social-proof {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: var(--success);
        font-size: 0.9rem;
        font-weight: 500;
        margin-bottom: 24px;
      }
      .social-proof::before {
        content: "‚úì";
        font-weight: 700;
      }

      /* Hero CTA Button */
      .btn-start {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        padding: 16px 32px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1.1rem;
        text-decoration: none;
        display: inline-block;
        box-shadow: 0 8px 20px rgba(37,99,235,0.3);
        transition: transform 0.2s, box-shadow 0.2s;
        border: none;
        cursor: pointer;
      }
      .btn-start:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 28px rgba(37,99,235,0.4);
      }
      .btn-start:active {
        transform: translateY(0);
      }

      /* Progress Indicator */
      .progress-bar {
        width: 100%;
        height: 4px;
        background: #e2e8f0;
        border-radius: 2px;
        margin-bottom: 24px;
        overflow: hidden;
      }
      .progress-fill {
        width: 0%;
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--success));
        transition: width 0.3s ease;
      }

      /* Form Card */
      .card {
        background: var(--card);
        padding: 28px;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        border: 1px solid var(--border);
        margin-bottom: 20px;
      }

      .section-title {
        font-weight: 700;
        margin-bottom: 8px;
        font-size: 1.15rem;
        color: var(--text);
      }

      .section-helper {
        color: var(--muted);
        font-size: 0.9rem;
        margin-bottom: 16px;
      }

      /* Radio Button Group */
      .radio-group {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .radio-item {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        padding: 16px;
        border: 2px solid var(--border);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s;
        background: white;
      }

      .radio-item:hover {
        border-color: var(--primary);
        background: #eff6ff;
      }

      .radio-item.selected {
        border-color: var(--primary);
        background: #eff6ff;
        box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
      }

      .radio-item input {
        margin-top: 4px;
        accent-color: var(--primary);
        transform: scale(1.3);
        cursor: pointer;
      }

      .radio-text {
        font-size: 0.95rem;
        line-height: 1.5;
        color: #334155;
      }

      .radio-text strong {
        color: var(--text);
        display: block;
        margin-bottom: 4px;
      }

      /* Text Input */
      textarea {
        width: 100%;
        padding: 14px;
        border: 2px solid var(--border);
        border-radius: 10px;
        font-family: inherit;
        font-size: 1rem;
        min-height: 100px;
        resize: vertical;
        transition: border-color 0.2s, box-shadow 0.2s;
      }

      textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
      }

      textarea::placeholder {
        color: #94a3b8;
      }

      /* Character Counter */
      .char-counter {
        text-align: right;
        font-size: 0.85rem;
        color: var(--muted);
        margin-top: 6px;
      }

      /* Sticky Footer */
      .sticky-footer {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background: white;
        padding: 16px 20px;
        border-top: 1px solid var(--border);
        box-shadow: 0 -4px 16px rgba(0,0,0,0.08);
        z-index: 100;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }

      .btn-save {
        width: 100%;
        max-width: 600px;
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        border: none;
        padding: 18px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 4px 12px rgba(37,99,235,0.3);
      }

      .btn-save:hover {
        transform: translateY(-1px);
        box-shadow: 0 6px 16px rgba(37,99,235,0.4);
      }

      .btn-save:active {
        transform: translateY(0);
      }

      .btn-save:disabled {
        background: #cbd5e1;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .trust {
        font-size: 0.8rem;
        text-align: center;
        color: var(--muted);
      }

      /* Success Modal */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 200;
        align-items: center;
        justify-content: center;
      }

      .modal-overlay.show {
        display: flex;
      }

      .modal {
        background: white;
        padding: 32px;
        border-radius: 16px;
        max-width: 400px;
        margin: 20px;
        text-align: center;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      }

      .modal h2 {
        margin: 0 0 16px;
        font-size: 1.5rem;
      }

      .modal p {
        color: var(--muted);
        margin-bottom: 24px;
      }

      .modal-buttons {
        display: flex;
        gap: 12px;
      }

      .btn-secondary {
        flex: 1;
        padding: 12px;
        border: 2px solid var(--border);
        background: white;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      }

      .btn-secondary:hover {
        border-color: var(--primary);
        color: var(--primary);
      }

      /* Mobile Optimization */
      @media (max-width: 600px) {
        h1 { font-size: 1.6rem; }
        .btn-start { padding: 14px 24px; font-size: 1rem; }
        .card { padding: 20px; }
        .sticky-footer { padding: 12px 16px; }
      }
    </style>
  </head>
  <body>
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-NPRM5NWS"
        height="0"
        width="0"
        style="display:none;visibility:hidden"
      ></iframe
    ></noscript>

    <div class="container">
      <header>
        <div class="badge">FREE TOOL ¬∑ NO SIGNUP</div>
        <h1>What Skill Will Make You<br />Valuable in 3 Years?</h1>
        <div class="sub">
          Based on Cal Newport's "So Good They Can't Ignore You"<br />
          Takes 2 minutes. Saved privately to your device.
        </div>
        <div class="social-proof">534 career plans created this week</div>

        <button class="btn-start" onclick="handleCtaClick()">Start Your Plan ‚Üí</button>
      </header>

      <!-- Progress Bar -->
      <div class="progress-bar">
        <div class="progress-fill" id="progress"></div>
      </div>

      <div id="form-section" class="card">
        <div class="section-title">Step 1: Choose Your Path</div>
        <div class="section-helper">Pick the strategy that resonates most with where you are now:</div>
        <div class="radio-group">
          <label class="radio-item" onclick="selectRadio(this)">
            <input type="radio" name="strategy" value="Build Rare Skills" onchange="trackInput('strategy')" />
            <div class="radio-text">
              <strong>üéØ Build Rare Skills</strong>
              I need to master a specific skill through deliberate practice
            </div>
          </label>
          <label class="radio-item" onclick="selectRadio(this)">
            <input type="radio" name="strategy" value="Gain Autonomy" onchange="trackInput('strategy')" />
            <div class="radio-text">
              <strong>üîì Gain Autonomy</strong>
              I have skills but need more control over my time and projects
            </div>
          </label>
          <label class="radio-item" onclick="selectRadio(this)">
            <input type="radio" name="strategy" value="Find Mission" onchange="trackInput('strategy')" />
            <div class="radio-text">
              <strong>üöÄ Find Mission</strong>
              I'm skilled but need meaningful work that drives impact
            </div>
          </label>
        </div>
      </div>

      <div class="card">
        <div class="section-title">Step 2: Reality Check</div>
        <div class="section-helper">What will you lose if you don't practice this skill?</div>
        <textarea
          id="input-check"
          placeholder="Example: My chance to lead the AI project, My edge over competitors, My career growth opportunity..."
          onfocus="trackStart('text_focus')"
          oninput="trackInput('input-check'); updateCharCount()"
        ></textarea>
        <div class="char-counter"><span id="char-count">0</span> characters</div>
      </div>

      <div style="height: 80px;"></div>
    </div>

    <!-- Sticky Footer -->
    <div class="sticky-footer">
      <button class="btn-save" id="save-btn" onclick="saveFrame()" disabled>üíæ Save My Career Plan</button>
      <div class="trust">üîí Private & Secure ¬∑ Saved locally to your device</div>
    </div>

    <!-- Success Modal -->
    <div class="modal-overlay" id="modal">
      <div class="modal">
        <h2>üéâ Plan Saved!</h2>
        <p id="modal-text">Your career capital strategy has been saved to your device.</p>
        <div class="modal-buttons">
          <button class="btn-secondary" onclick="closeModal()">Close</button>
          <button class="btn-start" style="flex: 1; padding: 12px;" onclick="shareResult()">Share</button>
        </div>
      </div>
    </div>

    <script>
      // --- State Management ---
      let hasStarted = false;
      let hasProgressed = false;
      let strategySelected = false;
      let textEntered = false;

      // --- Helper Functions ---
      function trackEvent(eventName, params = {}) {
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({ event: eventName, ...params });
      }

      function updateProgress() {
        const progress = document.getElementById('progress');
        const saveBtn = document.getElementById('save-btn');

        let percentage = 0;
        if (strategySelected) percentage += 50;
        if (textEntered) percentage += 50;

        progress.style.width = percentage + '%';

        // Enable save button when both completed
        if (percentage === 100) {
          saveBtn.disabled = false;
        }
      }

      function updateCharCount() {
        const textarea = document.getElementById('input-check');
        const counter = document.getElementById('char-count');
        counter.textContent = textarea.value.length;
      }

      // --- Radio Selection Visual Feedback ---
      function selectRadio(element) {
        document.querySelectorAll('.radio-item').forEach(item => {
          item.classList.remove('selected');
        });
        element.classList.add('selected');
      }

      // --- Analytics Tracking ---

      // 1. FRAME START: Fires ONCE on first interaction
      function trackStart(source) {
        if (!hasStarted) {
          trackEvent('frame_start', { field_name: source });
          hasStarted = true;
        }
      }

      // 2. CTA CLICK: Scroll to form + track
      function handleCtaClick() {
        trackStart('cta_button');
        trackEvent('cta_start_click');

        // Smooth scroll to form
        document.getElementById('form-section').scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });

        // Track scroll completion
        setTimeout(() => {
          trackEvent('scroll_to_form');
        }, 800);
      }

      // 3. INPUT PROGRESS: Track meaningful engagement
      function trackInput(type) {
        if (type === 'strategy') {
          trackStart('radio_selection');
          strategySelected = true;
          updateProgress();
        }

        if (type === 'input-check') {
          const textLen = document.getElementById('input-check').value.length;

          if (textLen > 10 && !textEntered) {
            textEntered = true;
            updateProgress();
          }

          // Fire progress event once
          if (!hasProgressed && textLen > 20) {
            trackEvent('frame_progress', {
              filled_count: strategySelected ? 2 : 1,
              text_length: textLen
            });
            hasProgressed = true;
          }
        }
      }

      // 4. SAVE (CONVERSION)
      function saveFrame() {
        const strategy = document.querySelector('input[name="strategy"]:checked');
        const check = document.getElementById('input-check').value;

        // Validation
        if (!strategy) {
          alert("‚ö†Ô∏è Please choose your path first (Step 1)");
          trackEvent('form_error', {
            error_field: 'strategy',
            error_message: 'not_selected'
          });
          document.querySelector('#form-section').scrollIntoView({
            behavior: 'smooth'
          });
          return;
        }

        if (check.length < 10) {
          alert("‚ö†Ô∏è Please complete the reality check (at least 10 characters)");
          trackEvent('form_error', {
            error_field: 'reality_check',
            error_message: 'too_short'
          });
          return;
        }

        // Save to localStorage
        const data = {
          strategy: strategy.value,
          reality_check: check,
          date: new Date().toISOString()
        };
        localStorage.setItem('career_plan_v2', JSON.stringify(data));

        // Track conversion
        trackEvent('frame_save', {
          book_id: 'BK-001',
          strategy_type: strategy.value,
          input_length_total: check.length
        });

        // Show success modal
        showModal(strategy.value, check);
      }

      // --- Modal Functions ---
      function showModal(strategy, check) {
        const modal = document.getElementById('modal');
        const modalText = document.getElementById('modal-text');

        modalText.innerHTML = `
          <strong>Strategy:</strong> ${strategy}<br>
          <strong>Focus:</strong> ${check.substring(0, 80)}${check.length > 80 ? '...' : ''}
        `;

        modal.classList.add('show');
      }

      function closeModal() {
        document.getElementById('modal').classList.remove('show');
      }

      function shareResult() {
        const url = window.location.href;
        const text = "I just created my career capital plan based on Cal Newport's framework!";

        if (navigator.share) {
          navigator.share({
            title: 'Career Capital Plan',
            text: text,
            url: url
          }).catch(() => {});
        } else {
          // Fallback: Copy to clipboard
          navigator.clipboard.writeText(url);
          alert("Link copied to clipboard!");
        }

        trackEvent('share_click');
      }

      // --- Initialize ---
      document.addEventListener('DOMContentLoaded', function() {
        // Check if returning user
        const saved = localStorage.getItem('career_plan_v2');
        if (saved) {
          trackEvent('returning_user');
        }
      });
    </script>
  </body>
</html>
